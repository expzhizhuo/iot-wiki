(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{701:function(_,v,e){"use strict";e.r(v);var i=e(81),t=Object(i.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h2",{attrs:{id:"_0x00-前言"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_0x00-前言"}},[_._v("#")]),_._v(" 0x00.前言")]),_._v(" "),v("blockquote",[v("p",[_._v("ipTIME在韩国的市场占有率高达60%-70%，是韩国市场最具代表性的物联网品牌。")]),_._v(" "),v("p",[_._v("设备型号：IpTime C200")]),_._v(" "),v("p",[_._v("漏洞固件版本：1.058及之前版本")]),_._v(" "),v("p",[_._v("修复固件版本：1.060或更高版本")]),_._v(" "),v("p",[_._v("固件下载地址：http://iptime.com/iptime/?pageid=1&page_id=126&keyword=C200&uid=24015")])]),_._v(" "),v("p",[_._v("之前我们分析了很多路由器的漏洞，相信很多人都已经有分析思路了，那么接下来我们来找一个摄像头的漏洞来进行分析。在"),v("code",[_._v("CVE")]),_._v("网站进行搜索，得到如下数据：")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511131344280.png",alt:"image-20220511131344280.png"}})]),_._v(" "),v("p",[_._v("当我们逐级去查看详情时，可以发现两个问题：")]),_._v(" "),v("ul",[v("li",[_._v("很多漏洞都是"),v("code",[_._v("1day")]),_._v("漏洞")]),_._v(" "),v("li",[_._v("摄像头的很多固件无法从官网获取")])]),_._v(" "),v("p",[_._v("根据上述问题，我们选择编号为"),v("code",[_._v("CVE-2021-26614")]),_._v("的"),v("code",[_._v("ipTIME")]),_._v("摄像头的"),v("code",[_._v("1day")]),_._v("进行分析，同时讲解一下"),v("code",[_._v("1day")]),_._v("漏洞的分析技巧。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511154058122.png",alt:"image-20220511154058122.png"}})]),_._v(" "),v("h2",{attrs:{id:"_0x01-漏洞信息"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_0x01-漏洞信息"}},[_._v("#")]),_._v(" 0x01.漏洞信息")]),_._v(" "),v("p",[_._v("根据链接跳转，查看相关描述信息。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511133011377.png",alt:"image-20220511133011377.png"}})]),_._v(" "),v("p",[_._v("根据描述信息可以得到如下信息：")]),_._v(" "),v("ul",[v("li",[_._v("漏洞固件版本：1.058及之前版本")]),_._v(" "),v("li",[_._v("修复固件版本：1.060或更高版本")]),_._v(" "),v("li",[_._v("漏洞触发应用"),v("code",[_._v("iux_get.cgi")]),_._v("，PS：描述中写错了")])]),_._v(" "),v("h2",{attrs:{id:"_0x02-环境搭建"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_0x02-环境搭建"}},[_._v("#")]),_._v(" 0x02.环境搭建")]),_._v(" "),v("p",[_._v("对于"),v("code",[_._v("1day")]),_._v("分析用的方式用的最多的方式就是补丁包对比分析，通过上面的描述可以很快定位到具体的固件版本及漏洞应用，接下来使用对比工具进行对比分析，对于不同的补丁使用的对比分析工具也不尽相同。")]),_._v(" "),v("ul",[v("li",[_._v("文本类（代码，文档等）："),v("code",[_._v("diff")]),_._v("，"),v("code",[_._v("Beyond Compare 4")]),_._v("等")]),_._v(" "),v("li",[_._v("二进制应用："),v("code",[_._v("bindiff")]),_._v("等")])]),_._v(" "),v("p",[_._v("通过产生漏洞的应用可以知道是一个二进制应用，所以我们这里简单说一下"),v("code",[_._v("bindiff")]),_._v("的安装及使用，通过链接"),v("code",[_._v("https://www.zynamics.com/software.html")]),_._v("可以下载对应版本的"),v("code",[_._v("bindiff")]),_._v("，这里我们安装的是"),v("code",[_._v("bindiff 7")]),_._v("，主要是原因是"),v("code",[_._v("bindiff7")]),_._v("内置"),v("code",[_._v("java")]),_._v("环境。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511135045701.png",alt:"image-20220511135045701.png"}})]),_._v(" "),v("p",[_._v("下载"),v("code",[_._v("bindiff7.msi")]),_._v("后，直接双击安装即可。启动"),v("code",[_._v("bindiff")]),_._v("配置"),v("code",[_._v("IDA")]),_._v("应用路径，这里我们使用的是"),v("code",[_._v("IDA 7.5")]),_._v("绿化版。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511135314931.png",alt:"image-20220511135314931.png"}})]),_._v(" "),v("p",[_._v("配置完成后，在"),v("code",[_._v("IDA")]),_._v("中也会同步出现"),v("code",[_._v("bindiff")]),_._v("插件，我们可以选择使用"),v("code",[_._v("bindiff")]),_._v("应用对比，也可以直接在"),v("code",[_._v("IDA")]),_._v("中进行对比。")]),_._v(" "),v("h2",{attrs:{id:"_0x03-漏洞分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_0x03-漏洞分析"}},[_._v("#")]),_._v(" 0x03.漏洞分析")]),_._v(" "),v("p",[_._v("根据链接"),v("code",[_._v("http://iptime.com/iptime/?pageid=1&page_id=126&keyword=C200&uid=24015")]),_._v("下载两个版本的固件。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511135556593.png",alt:"image-20220511135556593.png"}})]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511135545039.png",alt:"image-20220511135545039.png"}})]),_._v(" "),v("p",[_._v("固件没有进行加密处理，可以直接使用"),v("code",[_._v("binwalk")]),_._v("进行提取。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511140016982.png",alt:"image-20220511140016982.png"}})]),_._v(" "),v("p",[_._v("根据漏洞应用进行"),v("code",[_._v("grep")]),_._v("检索。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511140315715.png",alt:"image-20220511140315715.png"}})]),_._v(" "),v("p",[_._v("可以很快的定位到对应的应用，这时我们用"),v("code",[_._v("IDA")]),_._v("分别打开两个版本的"),v("code",[_._v("iux_get.cgi")]),_._v("，使用"),v("code",[_._v("bindiff")]),_._v("插件进行对比，查看改动的位置。PS："),v("code",[_._v("bindiff")]),_._v("对比依赖"),v("code",[_._v("IDA")]),_._v("生成的"),v("code",[_._v(".idb")]),_._v("文件")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511140645332.png",alt:"image-20220511140645332.png"}})]),_._v(" "),v("p",[_._v("使用"),v("code",[_._v("bindiff")]),_._v("插件打开"),v("code",[_._v("1.060")]),_._v("版本的"),v("code",[_._v("iux_get.cgi")]),_._v("使用"),v("code",[_._v("IDA")]),_._v("生成的"),v("code",[_._v("idb")]),_._v("文件。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511140754547.png",alt:"image-20220511140754547.png"}})]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511140811861.png",alt:"image-20220511140811861.png"}})]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511141243084.png",alt:"image-20220511141243084.png"}})]),_._v(" "),v("p",[_._v("通过"),v("code",[_._v("bindiff")]),_._v("的对比，可以知道修改代码的位置是"),v("code",[_._v("main")]),_._v("函数的位置，"),v("code",[_._v("Similarity")]),_._v("比"),v("code",[_._v("1.00")]),_._v("越小，说明代码修改的越多，"),v("code",[_._v("1.00")]),_._v("代表没有修改。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511141609914.png",alt:"image-20220511141609914.png"}})]),_._v(" "),v("p",[_._v("这里我们也可以直接使用"),v("code",[_._v("bindiff")]),_._v("应用分别加载两个版本的"),v("code",[_._v("idb")]),_._v("文件，来进行查看分析。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511143108960.png",alt:"image-20220511143108960.png"}})]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511143125284.png",alt:"image-20220511143125284.png"}})]),_._v(" "),v("p",[_._v("这里同样可以清晰的看到代码修复的位置。")]),_._v(" "),v("p",[_._v("可以看到删除了一个"),v("code",[_._v("debug")]),_._v("相关的逻辑，直接看"),v("code",[_._v("F5")]),_._v("生成伪"),v("code",[_._v("C")]),_._v("代码。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511141730339.png",alt:"image-20220511141730339.png"}})]),_._v(" "),v("p",[_._v("可能猜测是由于"),v("code",[_._v("sub_409748")]),_._v("函数造成的问题，进入该函数需要满足有"),v("code",[_._v("cam")]),_._v("和"),v("code",[_._v("debug")]),_._v("键值，双击跟进查看。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511141919514.png",alt:"image-20220511141919514.png"}})]),_._v(" "),v("p",[_._v("可以看到传递的值如果包含"),v("code",[_._v("cmd")]),_._v("，则会执行命令，并且通过上面的"),v("code",[_._v("debug")]),_._v("我们可以猜测应该是用于"),v("code",[_._v("debug")]),_._v("调试的代码，并且只要满足传递的键"),v("code",[_._v("aaksjdkfj")]),_._v("对应的值为"),v("code",[_._v("11dnjsrurelqjrm22")]),_._v("，即可满足条件（疑似厂商预留后门）。")]),_._v(" "),v("p",[v("img",{attrs:{src:"http://img.smile-space.com/image-20220511142456704.png",alt:"image-20220511142456704.png"}})]),_._v(" "),v("h2",{attrs:{id:"_0x04-总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_0x04-总结"}},[_._v("#")]),_._v(" 0x04.总结")]),_._v(" "),v("p",[_._v("通过上面我们已经很清晰的知道漏洞触发需要的条件，由于没有实体设备，所以这里并没有具体的执行效果。这里重点讲解了分析"),v("code",[_._v("1day")]),_._v("常用的分析技巧，可以帮助大家更快的定位产生漏洞的位置和编写"),v("code",[_._v("POC")]),_._v("，"),v("code",[_._v("EXP")]),_._v("。")])])}),[],!1,null,null,null);v.default=t.exports}}]);